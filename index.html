<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>留守資訊系統</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- 登入介面 -->
    <div id="login-section" class="login-section">
        <!-- 頂部標題欄（登入頁面版本） -->
        <header class="login-header">
            <!-- 中央標題 + 右側時間（精簡版） -->
            <div class="title-with-time">
                <h1 class="system-title">留守資訊系統</h1>
                <div id="login-time" class="login-time-inline">13:29:09</div>
            </div>
        </header>
        
        <!-- 中央登入卡片 -->
        <div class="login-container">
            <div class="login-card">
                <div class="login-header-icon">
                    <span class="system-icon">🏥</span>
                </div>
                <h1 class="login-title">留守資訊系統</h1>
                <p class="login-subtitle">歡迎使用專業的照護管理平台</p>
                
                <form id="login-form" class="login-form">
                    <div class="form-group">
                        <label for="username">帳號</label>
                        <div class="input-wrapper">
                            <span class="input-icon">👤</span>
                            <input type="text" id="username" name="username" placeholder="請輸入您的帳號" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="password">密碼</label>
                        <div class="input-wrapper">
                            <span class="input-icon">🔒</span>
                            <input type="password" id="password" name="password" placeholder="請輸入您的密碼" required>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <span class="btn-icon">🚀</span>
                        <span class="btn-text">登入系統</span>
                    </button>
                </form>
                
                <div class="login-info">
                    <div class="info-header">
                        <span class="info-icon">💡</span>
                        <span class="info-title">登入資訊</span>
                    </div>
                    <div class="credential-item">
                        <span class="key-icon">🔑</span>
                        <span>預設帳號：admin</span>
                    </div>
                    <div class="credential-item">
                        <span class="key-icon">🔑</span>
                        <span>預設密碼：123456</span>
                    </div>
                </div>
                
                <div class="login-footer-info">
                    <p class="footer-text">© 2024 留守資訊系統 - 專業照護管理解決方案</p>
                </div>
            </div>
        </div>
        
        <!-- 登入頁不再重複顯示底部時間，避免上下各一條時間列 -->
    </div>

    <!-- 主系統介面 -->
    <section id="main-section" class="main-section">
        <!-- 統一頂部標題欄 -->
        <header class="unified-header">
            <!-- 中央標題 + 右側時間（精簡版） -->
            <div class="title-with-time">
                <h1 class="system-title">留守資訊系統</h1>
                <div id="current-time" class="time-inline">13:29:09</div>
            </div>

            <!-- 右側用戶區塊 -->
            <div class="user-block">
                <button id="header-back-btn" class="header-back-btn" onclick="goBack()" style="display: none;">
                    <span>←</span> 主選單
                </button>
                <span class="user-icon">👤</span>
                <span class="user-name">admin</span>
                <button class="theme-btn" onclick="toggleTheme()">切換主題</button>
                <button class="logout-btn" onclick="logout()">登出</button>
            </div>
        </header>
        
        <!-- 主要內容區域 -->
        <div class="main-content">
            <!-- 功能選擇區域 -->
            <div id="function-selection" class="function-selection">
                <div class="function-header">
                    <h2>功能選擇</h2>
                    <p>請選擇您要使用的功能模組</p>
                </div>
                
                <div class="function-grid">
                    <!-- 卹滿照護功能 -->
                    <div class="function-card" onclick="navigateTo('care')">
                        <div class="card-icon">👥</div>
                        <h3>卹滿照護</h3>
                        <p>人員管理、資料查詢、匯出報表</p>
                    </div>
                    
                    <!-- 統計分析功能 -->
                    <div class="function-card" onclick="navigateTo('statistics')">
                        <div class="card-icon">📊</div>
                        <h3>統計分析</h3>
                        <p>資料統計、圖表分析、趨勢報告</p>
                    </div>
                    
                    <!-- 系統設定功能 -->
                    <div class="function-card" onclick="navigateTo('settings')">
                        <div class="card-icon">⚙️</div>
                        <h3>系統設定</h3>
                        <p>主題設定、資料備份、系統維護</p>
                    </div>
                    
                    <!-- 使用說明功能 -->
                    <div class="function-card" onclick="navigateTo('help')">
                        <div class="card-icon">❓</div>
                        <h3>使用說明</h3>
                        <p>操作指南、常見問題、聯絡支援</p>
                    </div>
                </div>
            </div>

            <!-- 卹滿照護區域 -->
            <section id="care" class="care-section" style="display: none;">
                <div class="care-container">
                    <div class="care-header">
                        <div class="care-header-content">
                            <button class="back-btn" onclick="navigateTo('function-selection')">
                                <span>←</span> 返回主選單
                            </button>
                            <h2>卹滿照護</h2>
                        </div>
                    </div>
                    
                    <!-- 篩選和搜尋區域 -->
                    <div class="filter-search-area">
                        <div class="filter-controls">
                            <div class="filter-group">
                                <label for="year-select">年份</label>
                                <select id="year-select" class="form-select">
                                    <option value="">請選擇年份</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label for="month-select">月份</label>
                                <select id="month-select" class="form-select">
                                    <option value="">請選擇月份</option>
                                </select>
                            </div>
                            <div class="search-group">
                                <input type="text" id="search-input" class="search-input" placeholder="搜尋姓名/個案號碼">
                            </div>
                        </div>
                        
                        <div class="action-buttons">
                            <button class="btn btn-success" onclick="showAddPersonForm()">新增人員</button>
                            <button class="btn btn-export" onclick="exportToCSV()">匯出本月 CSV</button>
                            <button class="btn btn-export-orange" onclick="exportToPDF()">匯出 PDF</button>
                            <button class="btn btn-check" onclick="checkPhotos()">檢查照片</button>
                        </div>
                    </div>
                    
                    <!-- 資料顯示區域 -->
                    <div class="data-display-area">
                        <div id="data-content" class="data-content">
                            <p class="no-data-message">目前沒有資料</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 統計分析區域 -->
            <section id="statistics" class="statistics-section" style="display: none;">
                <div class="statistics-container">
                    <div class="statistics-header">
                        <div class="statistics-header-content">
                            <button class="back-btn" onclick="navigateTo('function-selection')">
                                <span>←</span> 返回主選單
                            </button>
                            <h2>統計分析</h2>
                        </div>
                    </div>
                    
                    <div class="statistics-content">
                        <div class="statistics-card">
                            <h3>📈 本月統計</h3>
                            <div class="statistics-grid">
                                <div class="stat-item">
                                    <div class="stat-number" id="total-people">0</div>
                                    <div class="stat-label">總人數</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-number" id="pending-count">0</div>
                                    <div class="stat-label">待處理</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-number" id="completed-count">0</div>
                                    <div class="stat-label">已完成</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="statistics-card">
                            <h3>📅 月份分佈</h3>
                            <div class="setting-item" style="margin-bottom: 1rem;">
                                <label>選擇年份：</label>
                                <select id="stats-year-select" onchange="updateStatistics()" style="min-width: 120px;">
                                    <option value="">請選擇年份</option>
                                </select>
                            </div>
                            <div class="month-distribution" id="month-distribution">
                                <p>請選擇年份查看月份分佈</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 系統設定區域 -->
            <section id="settings" class="settings-section" style="display: none;">
                <div class="settings-container">
                    <div class="settings-header">
                        <div class="settings-header-content">
                            <button class="back-btn" onclick="navigateTo('function-selection')">
                                <span>←</span> 返回主選單
                            </button>
                            <h2>系統設定</h2>
                        </div>
                    </div>
                    
                    <div class="settings-content">
                        <div class="settings-card">
                            <h3>🎨 外觀設定</h3>
                            <div class="setting-item">
                                <label>主題模式</label>
                                <button class="btn btn-secondary" onclick="toggleTheme()">切換主題</button>
                            </div>
                        </div>
                        
                        <div class="settings-card">
                            <h3>🔧 系統工具</h3>
                            <div class="setting-item">
                                <label>資料維護</label>
                                <button class="btn btn-warning" onclick="fixDataFormat()">修復資料格式</button>
                            </div>
                            <div class="setting-item">
                                <label>測試功能</label>
                                <button class="btn btn-info" onclick="quickTest()">快速測試</button>
                            </div>
                            <div class="setting-item">
                                <label>資料備份</label>
                                <button class="btn btn-success" onclick="backupData()">備份資料</button>
                            </div>
                            <div class="setting-item">
                                <label>資料還原</label>
                                <button class="btn btn-export" onclick="restoreData()">還原資料</button>
                            </div>
                            <div class="setting-item">
                                <label>系統資訊</label>
                                <button class="btn btn-check" onclick="showSystemInfo()">查看系統資訊</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 使用說明區域 -->
            <section id="help" class="help-section" style="display: none;">
                <div class="help-container">
                    <div class="help-header">
                        <div class="help-header-content">
                            <button class="back-btn" onclick="navigateTo('function-selection')">
                                <span>←</span> 返回主選單
                            </button>
                            <h2>使用說明</h2>
                        </div>
                    </div>
                    
                    <div class="help-content">
                        <div class="help-card">
                            <h3>📖 快速入門</h3>
                            <div class="help-step">
                                <div class="step-number">1</div>
                                <div class="step-content">
                                    <h4>選擇功能</h4>
                                    <p>在主選單中點擊想要使用的功能模組</p>
                                </div>
                            </div>
                            <div class="help-step">
                                <div class="step-number">2</div>
                                <div class="step-content">
                                    <h4>操作功能</h4>
                                    <p>在功能頁面中進行具體操作</p>
                                </div>
                            </div>
                            <div class="help-step">
                                <div class="step-number">3</div>
                                <div class="step-content">
                                    <h4>返回主選單</h4>
                                    <p>點擊「返回主選單」按鈕回到功能選擇頁面</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="help-card">
                            <h3>❓ 常見問題</h3>
                            <div class="faq-item">
                                <h4>如何新增人員？</h4>
                                <p>進入「卹滿照護」功能，點擊「新增人員」按鈕，填寫表單後提交即可。</p>
                            </div>
                            <div class="faq-item">
                                <h4>如何匯出資料？</h4>
                                <p>在「卹滿照護」功能中，選擇年份月份後，點擊「匯出本月 CSV」或「匯出 PDF」按鈕。</p>
                            </div>
                            <div class="faq-item">
                                <h4>如何檢查照片完整性？</h4>
                                <p>選擇年份月份後，點擊「照片檢查」按鈕，系統會顯示該月份人員的照片完整度統計。</p>
                            </div>
                            <div class="faq-item">
                                <h4>如何標記案件完成？</h4>
                                <p>在人員卡片中，點擊「標記完成」連結，即可將案件狀態更新為已完成。</p>
                            </div>
                            <div class="faq-item">
                                <h4>如何備份和還原資料？</h4>
                                <p>進入「系統設定」功能，使用「資料備份」和「資料還原」按鈕進行資料管理。</p>
                            </div>
                            <div class="faq-item">
                                <h4>如何切換主題模式？</h4>
                                <p>在「系統設定」功能中，點擊「切換主題」按鈕即可在淺色和深色主題間切換。</p>
                            </div>
                        </div>
                        
                        <div class="help-card">
                            <h3>📋 功能說明</h3>
                            <div class="help-step">
                                <div class="step-number">👥</div>
                                <div class="step-content">
                                    <h4>卹滿照護</h4>
                                    <p>人員管理、資料查詢、匯出報表、照片檢查等核心功能</p>
                                </div>
                            </div>
                            <div class="help-step">
                                <div class="step-number">📊</div>
                                <div class="step-content">
                                    <h4>統計分析</h4>
                                    <p>本月統計、月份分佈圖表、資料分析等統計功能</p>
                                </div>
                            </div>
                            <div class="help-step">
                                <div class="step-number">⚙️</div>
                                <div class="step-content">
                                    <h4>系統設定</h4>
                                    <p>主題切換、資料維護、備份還原、系統工具等設定功能</p>
                                </div>
                            </div>
                            <div class="help-step">
                                <div class="step-number">❓</div>
                                <div class="step-content">
                                    <h4>使用說明</h4>
                                    <p>操作指南、常見問題、功能說明等幫助文件</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </section>

    <!-- 新增人員模態框 -->
    <div id="add-person-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>新增人員</h3>
                <span class="close" onclick="closeModal()">&times;</span>
            </div>
            <form id="add-person-form" class="modal-form">
                <!-- 基本資料區塊 -->
                <div class="form-section">
                    <div class="section-header">
                        <span class="section-icon">👤</span>
                        <h4>基本資料</h4>
                    </div>
                    <div class="form-group">
                        <label for="person-name">姓名 *</label>
                        <input type="text" id="person-name" name="name" placeholder="請輸入姓名" required>
                    </div>
                    <div class="form-group">
                        <label for="person-phone">電話 *</label>
                        <input type="tel" id="person-phone" name="phone" placeholder="請輸入電話號碼" required>
                    </div>
                    <div class="form-group">
                        <label for="person-address">地址 *</label>
                        <textarea id="person-address" name="address" rows="3" placeholder="請輸入完整地址" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="person-case-number">編號 *</label>
                        <input type="text" id="person-case-number" name="caseNumber" placeholder="請輸入編號" required>
                    </div>
                    <div class="form-group">
                        <label for="person-month">月份 *</label>
                        <select id="person-month" name="month" required>
                            <option value="">請選擇月份</option>
                            <option value="01">1月</option>
                            <option value="02">2月</option>
                            <option value="03">3月</option>
                            <option value="04">4月</option>
                            <option value="05">5月</option>
                            <option value="06">6月</option>
                            <option value="07">7月</option>
                            <option value="08">8月</option>
                            <option value="09">9月</option>
                            <option value="10">10月</option>
                            <option value="11">11月</option>
                            <option value="12">12月</option>
                        </select>
                    </div>
                </div>

                <!-- 備註與照片區塊 -->
                <div class="form-section">
                    <div class="section-header">
                        <span class="section-icon">💬</span>
                        <h4>備註與照片</h4>
                    </div>
                    <div class="form-group">
                        <label for="person-memo">備註</label>
                        <textarea id="person-memo" name="memo" rows="3" placeholder="請輸入備註資訊 (選填)"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="person-photo">照片 (可多選)</label>
                        <div class="file-upload-area">
                            <input type="file" id="person-photo" name="photo" accept="image/*" multiple>
                            <div class="file-upload-content">
                                <span class="file-upload-text">沒有選擇檔案</span>
                            </div>
                        </div>
                        <div class="file-info">
                            <span class="info-icon">ℹ️</span>
                            <span>支援 JPG、PNG、GIF 格式，可選擇多張照片</span>
                        </div>
                        <div id="photo-preview" class="photo-preview"></div>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">新增人員</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">返回列表</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 編輯人員模態框 -->
    <div id="edit-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>編輯人員資料</h3>
                <span class="close" onclick="closeModal()">&times;</span>
            </div>
            <form id="edit-form" class="modal-form">
                <input type="hidden" name="id">
                
                <!-- 基本資料區塊 -->
                <div class="form-section">
                    <div class="section-header">
                        <span class="section-icon">👤</span>
                        <h4>基本資料</h4>
                    </div>
                    <div class="form-group">
                        <label for="edit-name">姓名 *</label>
                        <input type="text" name="name" placeholder="請輸入姓名" required>
                    </div>
                    <div class="form-group">
                        <label for="edit-phone">電話 *</label>
                        <input type="tel" name="phone" placeholder="請輸入電話號碼" required>
                    </div>
                    <div class="form-group">
                        <label for="edit-address">地址 *</label>
                        <textarea name="address" rows="3" placeholder="請輸入完整地址" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="edit-memo">備忘</label>
                        <textarea name="memo" rows="3" placeholder="請輸入備忘資訊 (選填)"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="edit-year">年份 *</label>
                        <select name="year" required>
                            <option value="">請選擇年份</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="edit-month">月份 *</label>
                        <select name="month" required>
                            <option value="">請選擇月份</option>
                            <option value="1">1月</option>
                            <option value="2">2月</option>
                            <option value="3">3月</option>
                            <option value="4">4月</option>
                            <option value="5">5月</option>
                            <option value="6">6月</option>
                            <option value="7">7月</option>
                            <option value="8">8月</option>
                            <option value="9">9月</option>
                            <option value="10">10月</option>
                            <option value="11">11月</option>
                            <option value="12">12月</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="edit-status">狀態</label>
                        <select name="status">
                            <option value="pending">未完成</option>
                            <option value="completed">已完成</option>
                        </select>
                    </div>
                </div>

                <!-- 照片區塊 -->
                <div class="form-section">
                    <div class="section-header">
                        <span class="section-icon">📷</span>
                        <h4>照片</h4>
                    </div>
                    <div class="form-group">
                        <label for="edit-photo">更新照片</label>
                        <div class="file-upload-area">
                            <input type="file" name="photo" accept="image/*">
                            <div class="file-upload-content">
                                <span class="file-upload-text">選擇新照片 (選填)</span>
                            </div>
                        </div>
                        <div class="photo-preview"></div>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">更新資料</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">取消</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 通用模態框 -->
    <div id="modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div id="modal-body"></div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
